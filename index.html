<html>
    <head>
        <title>Idempotent Dice</title>
        <meta name="description" content="ハッシュ関数を利用した再現性のあるサイコロです。URL を渡すことで決まった内容を共有できます。"/>

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6580913532391800"
        crossorigin="anonymous"></script>
    </head>
    <body style=" background-color: snow;">
        <center>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6580913532391800"
                crossorigin="anonymous"></script>
            <!-- GetDestiny(entropy, branches) -->
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-6580913532391800"
                data-ad-slot="5596821234"
                data-ad-format="horizontal"
                data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </center>
        <div style="width: 800px; margin: 10px; padding: 40px; border: black solid 1px; border-radius: 10px; margin: 30px auto; background-color: white;">
            <div style="font-size: 32px; font-weight: bold;">Idempotent Dice</div>
            <div style="padding-top: 40px; font-size: 20px;">
                <form action="">
                    Choices - 選択肢を行区切りで入力する:<br />
                    <textarea name="b" id="branches" style="height: 240px; width: 800px; resize: vertical; margin-top: 10px; font-size: 20px; padding: 10px;" required="true"></textarea>
                    <div style="font-size: 16px;">
                        checksum: <span id="checksum" style="padding-left: 5px;"></span>
                    </div>
                    <br />

                    Entropy - 乱数の素:<br />
                    <input name="e" type="text" id="entropy" style="height: 40px; width: 800px; margin-top: 10px; font-size: 16px; padding: 10px;">
                    <select name="f" id="generate-entropy-format" style="height: 20px; width: 200px; font-size: 14px;" >
                        <option value="days">YYYY-MM-DD</option>
                        <option value="hours">YYYY-MM-DD HH:??</option>
                        <option value="minutes">YYYY-MM-DD HH:MM</option>
                    </select>
                    <button style="height: 20px; width: 120px; font-size: 14px;" onclick="insertTodayToEntropy(); return false;">set entropy</button><br />

                    <input type="submit" style="height: 50px; width: 140px; font-size: 20px; margin: 40px 0;" value="Roll Dice">
                </form>
            </div>

            <div id="resultBlock" hidden="true">
                <div style="margin-top: 4px; background-color: black; color: white; padding: 16px; border-radius: 10px; font-size: 40px; text-align: center;">
                    <span id="result"></span>
                </div>
            </div>
            <div style="margin-top: 10px; text-align: center;">
                <a onclick="navigator.clipboard.writeText(window.location.href); this.textContent = 'Copied ✓'; return false;" href="#">Copy URL</a>
            </div>

            <div style="margin-top: 30px; text-align: right;">
                <a onclick="initialize(); return false;" href="#">initialize</a>
            </div>
        </div>

        <center>ハッシュ関数を利用した再現性のあるサイコロです。URL を渡すことで決まった内容を共有できます。</center>
        <center style="padding-top: 10px"><a href="https://github.com/buri83/get-destiny">このツールについて</a></center>
        <center style="padding-top: 4px">
            <a href="https://twitter.com/buri_83">@buri_83</a>
        </center>

        <script src="./dist/main.js"></script>

        <script>
            function initialize() {
                window.location.href = '/';
            }

            function insertTodayToEntropy(){
                const format = document.getElementById("generate-entropy-format").value;
                const now = new Date();
                let entropy = "";
                switch(format){
                    case "days":
                        entropy =  `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;
                        break;
                    case "hours":
                        entropy =  `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()} ${now.getHours()}:??`;
                        break;
                    case "minutes":
                        entropy =  `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()} ${now.getHours()}:${now.getMinutes()}`;
                        break;
                }

                document.getElementById("entropy").value = entropy;
            }
        </script>
    </body>
</html>